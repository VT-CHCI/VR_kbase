<!DOCTYPE html>
<html>
<head>
  <title>VR Knowledgebase</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  
  <style>
      body {
        <% if user_signed_in? and current_user.admin %>
          padding-top: 100px;
        <% else %>
          padding-top: 60px;
        <% end %>
        padding-bottom: 40px;
      }

  </style>
</head>
<body>
  <!--[if lt IE 7]>
        <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
    <![endif]-->

    <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <div class="navbar-header">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">VR Knowledgebase</a>
        </div>
        <div class=" collapsenavbar-collapse">
          <ul class="nav navbar-nav">
            <!-- <li class="active"><a href="/">Home</a></li> -->
            <li><a href="/browse/index">Browse</a></li>
            <li><a href="/papers/new">Add New Paper</a></li>
          </ul>
          <%= form_tag browse_index_path, :method => :get, :html => { :class => "navbar-form pull-left", :role => "search" } do %>
            <%= text_field_tag :search, params[:search], :class => "search-query", :placeholder => "Search" %>
          <% end %>
          <ul class="nav navbar-nav pull-right">
            <li class="dropdown">
              <% if user_signed_in? %>
                <div class="btn-group">
                  <% if current_user.admin %>
                    <a class="btn btn-danger" href="/users/<%= current_user.id %>"><i class="icon-user icon-white"></i> <%= current_user.email %></a>
                    <a class="btn btn-danger dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret white-caret" ></span></a>
                  <% else %> 
                    <a class="btn btn-default" href="/users/<%= current_user.id %>"><i class="icon-user icon-white"></i> <%= current_user.email %></a>
                    <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret black-caret" ></span></a>
                  <% end %>
                  <ul class="dropdown-menu">
                    <li><%= link_to "Sign out", destroy_user_session_path, :class => "i", :method => :delete %></li>
                  </ul>
                </div>
              <% else %>
                <div class="btn-group">
                  <a class="btn btn-inverted" href="#"><i class="icon-user icon-white"></i> Not signed in</a>
                  <a class="btn btn-inverted dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret black-caret"></span></a>
                  <ul class="dropdown-menu">
                    <li><a href="#signinModal" data-toggle="modal" ><i class="i"></i> Sign in</a></li>
                    <li><a href="#signupModal" data-toggle="modal" ><i class="i"></i> Register</a></li>
                  </ul>
                </div>
              <% end %>
            </li> 
          </ul> 
        </div><!--/.nav-collapse -->
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="signinModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="width: 390px; margin: 0px 0px 0px -195px; position: fixed; top: 90px;">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="myModalLabel">Sign In</h3>
    </div>
    <div class="modal-body container-fluid" style="width: 300px; margin: 20px 30px 0px 30px;">
      <%= form_for :user, :url => session_path("user") do |user| %>
        <div class="row-fluid"><%= user.email_field :email, :class => "span12", :placeholder => "Email", :style => "margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.password_field :password, :class => "span12", :placeholder => "Password", :style => "margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.check_box :remember_me, :class => "checkbox inline", :style => "margin-bottom:20px;" %> <%= user.label :remember_me, "Remember me", :class => "checkbox inline", :style => "padding-left:0; margin-left:5px; margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.submit "Sign in", :class => "btn btn-primary span12" %></div>
      <% end %>
      <div class="row-fluid">Don't have an account? <a href="#signupModal" data-toggle="modal" onclick="$('#signinModal').modal('hide');">Register</a></div>
    </div>
  </div>

  <div id="signupModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="width: 390px; margin: 0px 0px 0px -195px; position: fixed; top: 90px;">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="myModalLabel">Register</h3>
    </div>
    <div class="modal-body container-fluid" style="width: 300px; margin: 20px 30px 0px 30px;">
      <%= form_for :user, :url => registration_path("user") do |user| %>
        <div class="row-fluid"><%= user.email_field :email, :class => "span12", :placeholder => "Email", :style => "margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.password_field :password, :class => "span12", :placeholder => "Password", :style => "margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.password_field :password_confirmation, :class => "span12", :placeholder => "Password", :style => "margin-bottom:20px;" %></div>
        <div class="row-fluid"><%= user.submit "Register", :class => "btn btn-primary span12" %></div>
      <% end %>
      <div class="row-fluid">Already have an account? <a href="#signinModal" data-toggle="modal" onclick="$('#signupModal').modal('hide');">Sign in</a></div>
      <div class="row-fluid"><%= link_to('Forgot password?', new_user_password_path) %></div>
    </div>
  </div>

  <% if user_signed_in? and current_user.admin %>
    <div class="navbar navbar second-navbar">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">Admin</a>
          
        <div class="nav-collapse collapse">
            <ul class="nav">
            <li><a href="/users">Manage Users</a></li>
            <li><a href="/validate/index">Latest Submissions</a></li>
            </ul>
        </div>
        </div>
      </div>
    </div>
  <% end %>
  
  <div class="container-fluid">
    <%= yield %>
    <!--<hr>

    <footer>
      <p>&copy; VR Knowledgebase 2014</p>
    </footer>-->
  </div>

</body>
</html>
